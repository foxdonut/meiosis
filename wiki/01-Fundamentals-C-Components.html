<!DOCTYPE html><html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="normalize.css">
<link rel="stylesheet" href="skeleton.css">
<link rel="stylesheet" href="prism.css">
<link rel="stylesheet" href="style.css">
</head>
<body class="container">
<script src="https://flems.io/flems.html" type="text/javascript" charset="utf-8"></script>
<script src="prism.js" type="text/javascript"></script>
<h1>Meiosis Wiki</h1><p><a href="toc.html">Table of Contents</a></p>
<h2>Components</h2><p>In this section, we&#39;ll look at structuring code into components.</p>
<h3>Components are plain objects and functions</h3><p>I use the term &quot;components&quot;, which means many different things to different people, contexts,
frameworks, and libraries.</p>
<p>I want to make it clear before going further that what I refer to in Meiosis as &quot;components&quot; are really just
plain objects and functions. Simple functions, or functions that return other functions, but just functions
nonetheless. There&#39;s no hidden behaviour and nothing magical. Most importantly, <em>you</em> decide how you want to
structure components.</p>
<p>I use &quot;components&quot; because &quot;objects&quot; and &quot;functions&quot; are too generic. I call &quot;components&quot; the building
blocks that are assembled together to create a web application.</p>
<h3>Component</h3><p>Here is a temperature component:</p>
<pre><code class="language-javascript">import { createActions } from &quot;./actions&quot;;
import { createView } from &quot;./view&quot;;

export const createTemperature = update =&gt; ({
  model: () =&gt; ({
    date: &quot;&quot;,
    value: 20,
    units: &quot;C&quot;
  }),

  view: createView(createActions(update))
});
</code></pre>
<p>We have a function to create the component, which receives <code>update</code>. We return an object with a
<code>model</code> function that returns the component&#39;s initial model, and a <code>view</code> function to render the
view. The view gets created from actions; actions are created by passing in <code>update</code>.</p>
<h3>Actions</h3><p>Actions call <code>update</code> to update the model:</p>
<pre><code class="language-javascript">export const createActions = update =&gt; ({
  editDate: evt =&gt;
    update(model =&gt; {
      model.date = evt.target.value;
      return model;
    }),

  increase: amount =&gt; _evt =&gt;
    update(model =&gt; {
      model.value = model.value + amount;
      return model;
    }),

  changeUnits: _evt =&gt; update(model =&gt; {
    if (model.units === &quot;C&quot;) {
      model.units = &quot;F&quot;;
      model.value = Math.round( model.value * 9 / 5 + 32 );
    }
    else {
      model.units = &quot;C&quot;;
      model.value = Math.round( (model.value - 32) / 9 * 5 );
    }
    return model;
  })
});
</code></pre>
<p>We have actions for:</p>
<ul>
<li>Editing the date.</li>
<li>Increasing the temperature. We can also decrease simply by passing a negative amount.</li>
<li>Changing the units between Celsius and Farenheit.</li>
</ul>
<p>The view can conveniently call these actions.</p>
<h3>View</h3><p>The view is straightforward:</p>
<pre><code class="language-javascript">export const createView = actions =&gt; model =&gt; (
  &lt;div&gt;
    &lt;div&gt;Date: &lt;input type=&quot;text&quot; size=&quot;10&quot; value={model.date}
                 onChange={actions.editDate}/&gt;&lt;/div&gt;
    &lt;span&gt;Temperature: {model.value}&amp;deg;{model.units} &lt;/span&gt;
    &lt;div&gt;
      &lt;button onClick={actions.increase(1)}&gt;Increase&lt;/button&gt;
      &lt;button onClick={actions.increase(-1)}&gt;Decrease&lt;/button&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;button onClick={actions.changeUnits}&gt;Change Units&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
);
</code></pre>
<p>The view simply renders the values from the model and calls actions when the user interacts
with the UI.</p>
<h3>The Meiosis Pattern</h3><p>We can now set up and use our component with the Meiosis Pattern:</p>
<pre><code class="language-javascript">import flyd from &quot;flyd&quot;;
import { createTemperature } from &quot;./temperature&quot;;

const update = flyd.stream();
const temperature = createTemperature(update);
const models = flyd.scan((model, func) =&gt; func(model),
  temperature.model(), update);

const element = document.getElementById(&quot;app&quot;);
models.map(model =&gt; ReactDOM.render(temperature.view(model), element));
</code></pre>
<p>Notice that the pattern works the same as before. After creating the <code>temperature</code> component,
we can get the initial model from its <code>model()</code> function, and render the view by calling
<code>temperature.view(model)</code>.</p>
<p>You can see the full code example and experiment with it below:</p>
  <div id="flems1" class="flemscode" style="height:700px"></div>

  <script>
    window.Flems(flems1, {
      files: [{name: "temperature.js", content: "const createActions = update => ({\n  editDate: evt =>\n    update(model => {\n      model.date = evt.target.value;\n      return model;\n    }),\n\n  increase: amount => _evt =>\n    update(model => {\n      model.value = model.value + amount;\n      return model;\n    }),\n\n  changeUnits: _evt => update(model => {\n    if (model.units === \"C\") {\n      model.units = \"F\";\n      model.value = Math.round( model.value * 9 / 5 + 32 );\n    }\n    else {\n      model.units = \"C\";\n      model.value = Math.round( (model.value - 32) / 9 * 5 );\n    }\n    return model;\n  })\n});\n\nconst createView = actions => model => (\n  <div>\n    <div>Date: <input type=\"text\" size=\"10\" value={model.date} onChange={actions.editDate}/></div>\n    <span>Temperature: {model.value}&deg;{model.units} </span>\n    <div>\n      <button onClick={actions.increase(1)}>Increase</button>\n      <button onClick={actions.increase(-1)}>Decrease</button>\n    </div>\n    <div>\n      <button onClick={actions.changeUnits}>Change Units</button>\n    </div>\n  </div>\n);\n\nconst createTemperature = update => ({\n  model: () => ({\n    date: \"\",\n    value: 20,\n    units: \"C\"\n  }),\n\n  view: createView(createActions(update))\n});\n\n", compiler: "babel"},{name: "index.js", content: "/* global ReactDOM, flyd */\n\nconst update = flyd.stream();\nconst temperature = createTemperature(update);\nconst models = flyd.scan((model, func) => func(model),\n  temperature.model(), update);\n\nconst element = document.getElementById(\"app\");\nmodels.map(model => ReactDOM.render(temperature.view(model), element));\n", compiler: "babel"},{name: "app.html", content: "<div id=\"app\"></div>\n<div id=\"tracer\"></div>\n"},{name: "app.css", content: "body, button {\n  font-family: sans-serif;\n  font-size: 1rem;\n}\nbutton, button.light {\n  cursor: pointer;\n  padding: 2px 8px 2px 8px;\n  color: #5755d9;\n  background-color: #ffffff;\n  border: 1px solid #5755d9;\n  margin: 4px;\n}\nbutton:hover {\n  background-color: #eeeeee;\n}\nbutton.dark {\n  background-color: #5755d9;\n  color: #ffffff;\n}\nbutton.dark:hover {\n  background-color: #7775f9;\n}\n.temperature {\n  margin-bottom: 20px;\n}"}],
      links: [{name: "react", type: "js", url: "https://unpkg.com/react@16.3.1/umd/react.development.js"},{name: "react-dom", type: "js", url: "https://unpkg.com/react-dom@16.3.1/umd/react-dom.development.js"},{name: "flyd", type: "js", url: "https://unpkg.com/flyd@0.2.6/flyd.js"}],
      middle: 75
    })
  </script>


<h3>Principles / Takeaways</h3><ul>
<li>We can create components with plain objects and functions.</li>
<li>Having <code>model</code> and <code>view</code> functions is one way to structure components, but not the only way.
Ultimately, you are in control of how you want to structure your components.</li>
</ul>
<h3>Up Next</h3><p>Before continuing to discuss components, we&#39;ll look at the time-travel development tool that Meiosis
provides, the <a href="01-Fundamentals-D-Using-the-Tracer.html">Meiosis Tracer</a>.</p>
<p><a href="toc.html">Table of Contents</a></p>
<hr>
<p>Meiosis is developed by <a href="http://twitter.com/foxdonut00">@foxdonut00</a> / <a href="https://github.com/foxdonut">foxdonut</a> and is released under the MIT license.</p>

</body></html>