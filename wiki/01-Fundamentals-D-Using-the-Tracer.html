<!DOCTYPE html><html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="normalize.css">
<link rel="stylesheet" href="skeleton.css">
<link rel="stylesheet" href="prism.css">
<link rel="stylesheet" href="style.css">
</head>
<body class="container">
<script src="https://flems.io/flems.html" type="text/javascript" charset="utf-8"></script>
<script src="prism.js" type="text/javascript"></script>
<h1><a href="http://meiosis.js.org">Meiosis</a> Wiki</h1><p><a href="toc.html">Table of Contents</a></p>
<h2>Using the Meiosis Tracer</h2><p>The <a href="https://github.com/foxdonut/meiosis-tracer">Meiosis Tracer</a> is a tool to observe, rewind, and replay streams
and see the results in the view. It&#39;s quite useful when developing and debugging an application.</p>
<p>Let&#39;s add the tracer to our <a href="01-Fundamentals-C-Components.html">previous example</a>.</p>
<h3>Tracing Streams</h3><p>Up to now, we haven&#39;t needed anything from Meiosis itself as a library. To use the tracer, we&#39;ll need to import
Meiosis and call its <code>trace</code> function. That will set up communication between the streams and the UI that displays
stream values and allows us to rewind, replay, and even type in stream values directly, all the while automatically
refreshing the view so that we can see the results.</p>
<p>You can see the tracer below:</p>
  <div id="flems1" class="flemscode" style="height:800px"></div>

  <script>
    window.Flems(flems1, {
      files: [{name: "temperature.js", content: "const createActions = update => ({\n  editDate: evt =>\n    update(model => {\n      model.date = evt.target.value;\n      return model;\n    }),\n\n  increase: amount => _evt =>\n    update(model => {\n      model.value = model.value + amount;\n      return model;\n    }),\n\n  changeUnits: _evt => update(model => {\n    if (model.units === \"C\") {\n      model.units = \"F\";\n      model.value = Math.round( model.value * 9 / 5 + 32 );\n    }\n    else {\n      model.units = \"C\";\n      model.value = Math.round( (model.value - 32) / 9 * 5 );\n    }\n    return model;\n  })\n});\n\nconst createView = actions => model => (\n  <div>\n    <div>Date: <input type=\"text\" size=\"10\" value={model.date} onChange={actions.editDate}/></div>\n    <span>Temperature: {model.value}&deg;{model.units} </span>\n    <div>\n      <button onClick={actions.increase(1)}>Increase</button>\n      <button onClick={actions.increase(-1)}>Decrease</button>\n    </div>\n    <div>\n      <button onClick={actions.changeUnits}>Change Units</button>\n    </div>\n  </div>\n);\n\n// eslint-disable-next-line no-unused-vars\nconst createTemperature = update => ({\n  model: () => ({\n    date: \"\",\n    value: 20,\n    units: \"C\"\n  }),\n\n  view: createView(createActions(update))\n});\n\n", compiler: "babel"},{name: "index.js", content: "/* global ReactDOM, flyd, createTemperature, meiosis, meiosisTracer */\n\nconst update = flyd.stream();\nconst temperature = createTemperature(update);\nconst models = flyd.scan((model, func) => func(model),\n  temperature.model(), update);\n\nconst element = document.getElementById(\"app\");\nmodels.map(model => ReactDOM.render(temperature.view(model), element));\n\n// Only for using Meiosis Tracer in development.\nmeiosis.trace({ update, dataStreams: [ models ]});\nmeiosisTracer({ selector: \"#tracer\" });\n", compiler: "babel"},{name: "app.html", content: "<div id=\"app\"></div>\n<div id=\"tracer\"></div>\n"},{name: "app.css", content: "body, button {\n  font-family: sans-serif;\n  font-size: 1rem;\n}\nbutton, button.light {\n  cursor: pointer;\n  padding: 2px 8px 2px 8px;\n  color: #5755d9;\n  background-color: #ffffff;\n  border: 1px solid #5755d9;\n  margin: 4px;\n}\nbutton:hover {\n  background-color: #eeeeee;\n}\nbutton.dark {\n  background-color: #5755d9;\n  color: #ffffff;\n}\nbutton.dark:hover {\n  background-color: #7775f9;\n}\n.temperature {\n  margin-bottom: 20px;\n}"}],
      links: [{name: "react", type: "js", url: "https://unpkg.com/react@16.3.1/umd/react.development.js"},{name: "react-dom", type: "js", url: "https://unpkg.com/react-dom@16.3.1/umd/react-dom.development.js"},{name: "flyd", type: "js", url: "https://unpkg.com/flyd@0.2.6/flyd.js"},{name: "meiosis", type: "js", url: "https://unpkg.com/meiosis@1.3.0/dist/meiosis.min.js"},{name: "meiosis-tracer", type: "js", url: "https://unpkg.com/meiosis-tracer@1.3.0/dist/meiosis-tracer.min.js"}],
      middle: 75
    })
  </script>


<p>To trace streams, we need to import the Meiosis library and call the <code>trace</code> function, passing the <code>update</code> stream
and a <code>dataStreams</code> array of streams to trace:</p>
<pre><code class="language-javascript">meiosis.trace({ update, dataStreams: [ models ]});
</code></pre>
<p>The second thing to do is to use the Meiosis Tracer UI. We have two options to do this:</p>
<ol>
<li>Import the Meiosis Tracer and add a DOM element to our page to hook up the UI, or</li>
<li>Use the
<a href="https://chrome.google.com/webstore/detail/meiosis-tracer/lcomllmppaiciocfbeefdeoplnfpnnfl">Chrome extension</a>
in which case we do <em>not</em> need to import the Meiosis Tracer, nor do we need to change our page. The extension
displays the Tracer UI in Chrome&#39;s DevTools.</li>
</ol>
<h3>Using Meiosis Tracer</h3><p>Let&#39;s start with the first option. In the HTML, we&#39;ve added a <code>&lt;div&gt;</code> where the tracer will be displayed:</p>
<pre><code class="language-html">&lt;div id=&quot;tracer&quot;&gt;&lt;/div&gt;
</code></pre>
<p>Notice that we&#39;ve given it an <code>id</code> of <code>tracer</code>. Finally, we initialize the Tracer by passing it the selector
to our <code>&lt;div&gt;</code>:</p>
<pre><code class="language-javascript">meiosisTracer({ selector: &quot;#tracer&quot; });
</code></pre>
<p>That will display the Tracer on our page.</p>
<h3>Using the Chrome Extension</h3><p>The second option to use the Tracer is to install the
<a href="https://chrome.google.com/webstore/detail/meiosis-tracer/lcomllmppaiciocfbeefdeoplnfpnnfl">Chrome extension</a>.
In that scenario, we still need to call the Meiosis <code>trace</code> function, but no other changes are needed in our
application.</p>
<p>When you open Chrome&#39;s DevTools, you&#39;ll see a Meiosis tab. The UI works best if you dock the DevTools on the
right side of the browser window.</p>
<h3>Rewind, Replay, Observe</h3><p>Try entering values in the text fields of the example, increasing and decreasing the temperature, and then click
on the Save button. As you are doing this, you&#39;ll see snapshots of the model being displayed in the tracer. You&#39;ll
also notice an increase in the total number on the slider.</p>
<p>Next, try dragging the slider back towards the left, and then towards the right. You&#39;ll see that you are rewinding
and replaying the model snapshots, with the view showing the corresponding results.</p>
<p>Finally, try typing in values directly in the model textarea. As long as you have valid JSON, you should see the
view reflect the result of rendering with the model that you&#39;ve entered.</p>
<p>This is a great way to develop and debug an application. You can see what the view looks like for a given model.
If you enter a temperature value, you&#39;ll see it in the view. If you change the temperature units from <code>C</code> to <code>F</code>,
you see in fact that the view does <em>not</em> reflect the change. You&#39;ve discovered that we are not (yet) using the
units from the model! We&#39;ll be fixing that in the next part.</p>
<h3>Principles / Takeaways</h3><ul>
<li>The Meiosis Tracer is useful for observing, replaying, and experimenting with streams in your application.</li>
<li>You can easily add the Tracer to your application, and remove it when you are done.</li>
<li>If you use the Chrome DevTools Extension, it&#39;s even easier: you only need to add one line of code (<code>trace</code>).</li>
</ul>
<h3>Up Next</h3><p>Let&#39;s take a step back and summarize what we&#39;ve learned by looking at the <a href="01-Fundamentals-E-Goals.html">Meiosis Goals</a>.</p>
<p><a href="toc.html">Table of Contents</a></p>
<hr>
<p><a href="http://meiosis.js.org">Meiosis</a> is developed by <a href="http://twitter.com/foxdonut00">@foxdonut00</a> / <a href="https://github.com/foxdonut">foxdonut</a> and is released under the MIT license.</p>

</body></html>