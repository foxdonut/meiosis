<!DOCTYPE html>
<html>
<head>
<title>Meiosis Documentation</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="normalize.css">
<link rel="stylesheet" href="skeleton.css">
<link rel="stylesheet" href="prism.css">
<link rel="stylesheet" href="docs.css">
</head>
<body class="container">
<script src="prism.js" type="text/javascript"></script>
<script src="flems.html" type="text/javascript" charset="utf-8"></script>
<div class="lesson">
<h1><a href="https://meiosis.js.org/setup">meiosis-setup</a> Documentation</h1><div class="docs-nav">
  <a href="setup-nested-components.html"><span class="nav-prev">
        <span class="arrow">&#x2B05;</span>
        <span class="title">Nested Components</span>
      </span></a>
  <a class="toc" href="setup-toc.html">&#x2B06; Contents</a>
  <a href="setup-stream-implementation.html"><span class="nav-next">
        <span class="arrow">&#x27A1;</span>
        <span class="title">Stream Implementation</span>
      </span></a>
</div>

<h2>TypeScript Support</h2><blockquote>
<p>This section is work-in-progress.</p>
</blockquote>
<p><code>meiosis-setup</code> provides TypeScript support so that you can have type checking, auto-suggest, and
other TypeScript features in your Meiosis code.</p>
<h3>State Type</h3><p>The first thing we need to do is to define a type for our application state.</p>
<pre><code class="language-ts">interface State {
  name: string;
  age: number;
}
</code></pre>
<p>Then, we can set up Meiosis with TypeScript as follows:</p>
<pre><code class="language-ts">import { meiosisSetup } from &#39;meiosis-setup&#39;;

const cells = meiosisSetup&lt;State&gt;();

const cell = cells();
</code></pre>
<p>Now, we have a stream of cells with each cell having <code>state</code> of type <code>State</code> and having <code>update</code>
taking patches that must be compatible with <code>State</code>.</p>
<p>In the example below, you can experiment with TypeScript support. Try the following:</p>
<ul>
<li>On the line with <code>cell</code>, add a dot (.) after <code>cell</code> and see the auto-suggested <code>cell</code> properties.</li>
<li>On the line with <code>cell.state</code>, add a dot (.) after <code>state</code> and see the auto-suggested properties,
<code>name</code> and <code>age</code>.</li>
<li>Uncomment the line <code>cell.update({ invalid: true });</code> and see the patch in error since <code>&#39;invalid&#39;</code>
is not a property of <code>State</code>.</li>
<li>Uncomment the line <code>cell.update({ age: &#39;not valid&#39;});</code> and see the patch in error since
<code>&#39;not valid&#39;</code> is not a <code>number</code>.</li>
</ul>
<iframe src="https://stackblitz.com/github/foxdonut/meiosis/tree/master/helpers/setup/examples?embed=1&terminalHeight=0&ctl=1&view=editor&file=src/ts/support/basic.ts" style="width:100%;height:500px"></iframe>

<h3>Initial State</h3><p>To indicate the initial state, we use the <code>initial</code> property of an <code>app</code> object that we pass to
<code>meiosisSetup()</code>.</p>
<p>With TypeScript, <code>app</code> is of type <code>MeiosisComponent</code>, which we can import from
<code>&#39;meiosis-setup/types&#39;</code>. By indicating our <code>State</code> type, our <code>app</code>&#39;s initial state will be
validated.</p>
<pre><code class="language-ts">import { meiosisSetup } from &#39;meiosis-setup&#39;;
import { MeiosisComponent } from &#39;meiosis-setup/types&#39;;

const app: MeiosisComponent&lt;State&gt; = {
  initial: {
    age: 25
  }
};

const cells = meiosisSetup&lt;State&gt;({ app });
</code></pre>
<p>By specifying the <code>MeiosisComponent</code> type on our <code>app</code> object, it will be validated and we can also
benefit from auto-suggest on the properties (<code>initial</code>, <code>services</code>, etc.)</p>
<p>In the example below, try the following in the <code>initial</code> object, which should result in an error:</p>
<ul>
<li>Specify a property that does not exist on the <code>State</code> type.</li>
<li>Specify a value that does not match the type, for example a <code>string</code> on the <code>age</code> property.</li>
</ul>
<iframe src="https://stackblitz.com/github/foxdonut/meiosis/tree/master/helpers/setup/examples?embed=1&terminalHeight=0&ctl=1&view=editor&file=src/ts/support/initial.ts" style="width:100%;height:500px"></iframe>

<h3>Services</h3><p>We can use the <code>Service</code> type for services. This will auto-suggest and validate the properties of a
service (<code>onchange</code>, <code>run</code>) and automatically type the function parameters.</p>
<pre><code class="language-ts">import { meiosisSetup } from &#39;meiosis-setup&#39;;
import { MeiosisComponent, Service } from &#39;meiosis-setup/types&#39;;

interface State {
  name: string;
  age: number;
}

const service: Service&lt;State&gt; = {
  onchange: (state) =&gt; state.age,
  run: (cell) =&gt; {
    cell.update({ age: (value) =&gt; value + 1 });
  }
};

const app: MeiosisComponent&lt;State&gt; = {
  services: [service]
};

const cells = meiosisSetup&lt;State&gt;({ app });
</code></pre>
<p>Below, you can see this in action:</p>
<ul>
<li>Invalid properties cannot be specified on the <code>service</code> object.</li>
<li>The <code>state</code> parameter on the <code>onchange</code> function, as well as the <code>cell</code> parameter on the <code>run</code>
function, are automatically typed.</li>
<li>An invalid service object, such as <code>{}</code>, cannot be specified in the <code>services</code> array.</li>
</ul>
<iframe src="https://stackblitz.com/github/foxdonut/meiosis/tree/master/helpers/setup/examples?embed=1&terminalHeight=0&ctl=1&view=editor&file=src/ts/support/services.ts" style="width:100%;height:500px"></iframe>

<h3>Nested Cells</h3><p>By calling <code>cell.nest(&#39;...&#39;)</code>, we can create a nested cell. With TypeScript support, when entering a
string within <code>nest(&#39;&#39;)</code>, auto-suggest indicates valid properties. Moreover, specifying an invalid
property results in an error.</p>
<p>Once we have a nested cell, <code>cell.state.x..</code> auto-suggested nested properties, as does
<code>cell.update({ x: ... })</code>.</p>
<p>Try experimenting with the code below.</p>
<iframe src="https://stackblitz.com/github/foxdonut/meiosis/tree/master/helpers/setup/examples?embed=1&terminalHeight=0&ctl=1&view=editor&file=src/ts/support/nested-cells.ts" style="width:100%;height:500px"></iframe>

<h3>Nested Components</h3><iframe src="https://stackblitz.com/github/foxdonut/meiosis/tree/master/helpers/setup/examples?embed=1&terminalHeight=0&ctl=1&view=editor&file=src/ts/support/nested-components.ts" style="width:100%;height:500px"></iframe>

<h3>API Documentation</h3><p><a href="ts-docs/index.html">TypeScript API documentation is here.</a></p>
<div class="docs-nav">
  <a href="setup-nested-components.html"><span class="nav-prev">
        <span class="arrow">&#x2B05;</span>
        <span class="title">Nested Components</span>
      </span></a>
  <a class="toc" href="setup-toc.html">&#x2B06; Contents</a>
  <a href="setup-stream-implementation.html"><span class="nav-next">
        <span class="arrow">&#x27A1;</span>
        <span class="title">Stream Implementation</span>
      </span></a>
</div>


<div>
<a href="https://meiosis.js.org">Meiosis</a> is developed by foxdonut
(<a href="https://twitter.com/foxdonut00">Twitter</a> /
<a href="https://github.com/foxdonut">GitHub</a>) and is released under the MIT license.
</div>
</div>
</body>
</html>