<!DOCTYPE html>
<html>
<head>
<title>Meiosis Documentation</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="normalize.css">
<link rel="stylesheet" href="skeleton.css">
<link rel="stylesheet" href="prism.css">
<link rel="stylesheet" href="docs.css">
</head>
<body class="container">
<script src="prism.js" type="text/javascript"></script>
<script src="flems.html" type="text/javascript" charset="utf-8"></script>
<div class="lesson">
<h1><a href="https://meiosis.js.org/router">meiosis-router</a> Documentation</h1><div class="docs-nav">
  <a href="router-overview.html"><span class="nav-prev">
        <span class="arrow">&#x2B05;</span>
        <span class="title">Overview</span>
      </span></a>
  <a class="toc" href="router-toc.html">&#x2B06; Contents</a>
  <a href="router-history-mode.html"><span class="nav-next">
        <span class="arrow">&#x27A1;</span>
        <span class="title">Setup / History Mode</span>
      </span></a>
</div>

<h2>Setup / Hash Mode</h2><p>Let&#39;s look at how we can set up <code>meiosis-router</code>, first in Hash Mode (this section), then in History
Mode (next section).</p>
<p>Make sure you have installed it, using
<a href="https://github.com/foxdonut/meiosis/tree/master/helpers/router#installation">these instructions</a>.</p>
<p>To create the router, we need to define a route configuration. This is a simple key-value object
with route paths associated to strings. The strings identify the pages of our application.</p>
<p>Then, we can create the router using <code>createRouter({ routeConfig })</code>.</p>
<p>For example:</p>
<pre><code class="language-js">// router.js
import { createRouter } from &#39;meiosis-router&#39;;

// We are defining constants for convenience, but this is not a requirement.
export const Page = {
  Home: &#39;Home&#39;,
  Login: &#39;Login&#39;,
  User: &#39;User&#39;,
  NotFound: &#39;NotFound&#39;
};

export const routeConfig = {
  &#39;/&#39;: Page.Home,
  &#39;/login&#39;: Page.Login,
  &#39;/user/:id&#39;: Page.User,
  &#39;/*&#39;: Page.NotFound
};

export const router = createRouter({ routeConfig });
</code></pre>
<p>This sets up the router in Hash Mode, which uses <code>#!</code> as a prefix in routes.</p>
<p>We defined a <code>Page</code> constant for convenience, but this is not strictly necessary. You could use
strings directly in the <code>routeConfig</code> object, if you prefer.</p>
<p>The <code>routeConfig</code> object defines the route paths and their associated page identifiers.</p>
<p>Notice that we can use a colon, <code>:</code>, for path parameters, such as <code>/user/:id</code>.</p>
<p>Also notice the last route, <code>&#39;/*&#39;</code>, which catches all routes that match none of the others. We can
use this to display a friendly &quot;page not found&quot; message to the user.</p>
<p>Now, we&#39;ve created and exported <code>router</code>, which we can import and use:</p>
<pre><code class="language-js">// index.js
import { meiosisSetup } from &#39;meiosis-setup&#39;;
import { router } from &#39;./router&#39;;

const app = {
  initial: {
    route: router.initialRoute
  }
};

const cells = meiosisSetup({ app });
const cell = cells();

router.start((route) =&gt; cell.update({ route: () =&gt; route }));

cells.map((cell) =&gt; {
  router.syncLocationBar(cell.state.route);
});
</code></pre>
<p>This is a regular Meiosis setup. In our initial application state, we use <code>router.initialRoute</code> to
indicate the first <code>route</code>.</p>
<p>To respond to route changes and update the <code>route</code> in the application state, we use:</p>
<pre><code class="language-js">router.start((route) =&gt; cell.update({ route: () =&gt; route }));
</code></pre>
<ul>
<li>The URL in the browser&#39;s location bar changes: by clicking on a link, typing in the location bar,
etc.</li>
<li><code>meiosis-router</code> listens for these changes and calls the function passed to <code>start</code></li>
<li>the function updates the route in the application state by calling <code>cell.update(...)</code>.</li>
</ul>
<p>Finally, to keep the browser&#39;s location bar in sync with the route when we change the route
programmatically by updating the application state, we use:</p>
<pre><code class="language-js">cells.map((cell) =&gt; {
  router.syncLocationBar(cell.state.route);
});
</code></pre>
<ul>
<li>When the application state changes, <code>meiosis-router</code> keeps the browser&#39;s location bar in sync with
the application state route</li>
<li>Thus, when you change the route programmatically by changing it in the application state with
<code>cell.update(...)</code>, the browser&#39;s location bar will automatically change accordingly and
correspond to the route.</li>
</ul>
<div class="docs-nav">
  <a href="router-overview.html"><span class="nav-prev">
        <span class="arrow">&#x2B05;</span>
        <span class="title">Overview</span>
      </span></a>
  <a class="toc" href="router-toc.html">&#x2B06; Contents</a>
  <a href="router-history-mode.html"><span class="nav-next">
        <span class="arrow">&#x27A1;</span>
        <span class="title">Setup / History Mode</span>
      </span></a>
</div>

<hr>
<div>
<a href="https://meiosis.js.org">Meiosis</a> is developed by foxdonut
(<a href="https://twitter.com/foxdonut00">Twitter</a> /
<a href="https://github.com/foxdonut">GitHub</a>) and is released under the MIT license.
</div>
</div>
</body>
</html>